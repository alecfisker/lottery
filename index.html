<html>
<script src="ethers-5.6.4.umd.min.js" type="application/javascript"></script>
<script language="javascript">
//connect wallet
//show tikets number
//show jackpot value
//buy ticket button - call buy tiket contract function
//scratch ticket - call contract scratch fucntion, reduce ticket balacne 1 item, pay rnd win in nativ token

	
	
function onLoadDone()
{


	 window.ethereum.enable().then(function(accounts){
console.log(' window.ethereum.enable');
           ethereum.on('accountsChanged', function (accounts) {
       //function to perform on account change
       })
    })

	
//const urlSearchParams = new URLSearchParams(window.location.search);
//	const params = Object.fromEntries(urlSearchParams.entries());

	//console.log(urlSearchParams );
	//console.log(params['cuid'] );
	
	
	//if(!params['cuid']) 
	//{
//		cuid = Math.floor(Math.random() * 1000000000);
		//window.location.href = window.location.href + '?cuid=' + cuid ;
	//}
	//else
	//{
//		cuid = params['cuid'];
//	}
	
	setTimeout(function () 	{				web3_metamask_login();			}, 		3000);
		
		
	}	
	
	
 async function web3_metamask_login() {
                // Check first if the user has the MetaMask installed
                if ( web3_check_metamask() ) {
	console.log('Initate Login Process');

	// Get the Ethereum provider
	const provider = new ethers.providers.Web3Provider(window.ethereum);                    
	// Get Ethereum accounts
	await provider.send("eth_requestAccounts", []);
	console.log("Connected!!"); 
	// Get the User Ethereum address
	const address = await provider.getSigner().getAddress();
	console.log(address);                    
	client_address = address;
	document.getElementById('metamask_address').innerHTML="Address " + address.substring(0,11) + '.. ';// + '<img style="display:inline;" src="net_icon.png" width="30px">';


	let abi = ["function approve(address spender, uint256 value) public returns (bool success)"];
	//let provider = window.web3;
	//const ethers = Moralis.web3Library;

	//const provider = new ethers.providers.Web3Provider(window.ethereum);
	const accounts = await provider.listAccounts();
	console.log(accounts[0]);
	//const signer = provider.getSigner();
	//console.log(signer);
	//const signer = ethers.getSigner();
	//let contract = new ethers.Contract("0x33933D8Aec4a5381DE8607B563180c8C53FD70c3", abi, signer);
	//resp = await contract.approve(window.web3.currentProvider.selectedAddress, 100000000*10000000);	
					
                }
            }   
			
 function web3_check_metamask() {
                if (!window.ethereum) {
                    console.error('It seems that the MetaMask extension is not detected. Please install MetaMask first.');
                    alert('It seems that the MetaMask extension is not detected. Please install MetaMask first.');
                    return false;
                }else{
                    console.log('MetaMask extension has been detected!!');
                    return true;
                }
            }  	
	
</script>

<body style="background-color:#134529;" onload="onLoadDone();">
<div style='background-position: center;background-size: center;background-image: url("lottery_background_a.png");width:1326;height:743;
  justify-content: center;margin:0 auto;text-align:center;'>

<br><br>
<span id=metamask_address 
style="padding:10px;text-shadow: -2px -2px 0 #154c2c, 2px -2px 0 #154c2c, -2px 2px 0 #154c2c, 2px 2px 0 #154c2c;color:#bae5b7;font-weight:bold; font-family: Verdana, sans-serif;font-size: 30px;background-color:#1d6b3e;border-radius: 5px;"
>
Connect With Metamask
</span>
<br><br><br><br>

<span id="" 
style="padding:10px;text-shadow: -2px -2px 0 #154c2c, 2px -2px 0 #154c2c, -2px 2px 0 #154c2c, 2px 2px 0 #154c2c;color:#bae5b7;font-weight:bold; font-family: Verdana, sans-serif;font-size: 30px;background-color:#1d6b3e;border-radius: 5px;"
>
Owned Tickets 4</span>

<br><br><br><br>

<a style="text-decoration: none;" href="#" onclick="scratch();return false;">
<span id="" 
style="padding:10px;text-shadow: -2px -2px 0 #154c2c, 2px -2px 0 #154c2c, -2px 2px 0 #154c2c, 2px 2px 0 #154c2c;color:#bae5b7;font-weight:bold; font-family: Verdana, sans-serif;font-size: 30px;background-color:#1d6b3e;border-radius: 5px;"
>
Scratch Ticket</span>
</a>
<br><br><br><br>

<span id="" 
style="padding:10px;text-shadow: -2px -2px 0 #154c2c, 2px -2px 0 #154c2c, -2px 2px 0 #154c2c, 2px 2px 0 #154c2c;color:#bae5b7;font-weight:bold; font-family: Verdana, sans-serif;font-size: 30px;background-color:#1d6b3e;border-radius: 5px;"

>Jackpot Value 94k USDT</span>

<br><br><br><br>

<span id="" 
style="padding:10px;text-shadow: -2px -2px 0 #154c2c, 2px -2px 0 #154c2c, -2px 2px 0 #154c2c, 2px 2px 0 #154c2c;color:#bae5b7;font-weight:bold; font-family: Verdana, sans-serif;font-size: 30px;background-color:#1d6b3e;border-radius: 5px;"

>Buy Ticket</span>

</div>


</body>
</html>
